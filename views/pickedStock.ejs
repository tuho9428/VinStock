<!DOCTYPE html>
<html style="font-size: 16px" lang="en">
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta charset="utf-8" />
    <meta
      name="keywords"
      content="Billionaires Peter Thiel and Alan Howard back new $10bn crypto exchange"
    />
    <meta name="description" content="" />
    <title>Home</title>
    <link rel="stylesheet" href="/styles/vinpage.css" media="screen" />
    <link rel="stylesheet" href="/styles/styles.css" />
    <script
      class="u-script"
      type="text/javascript"
      src="/scripts/jquery.js"
      defer=""
    ></script>
    <script
      class="u-script"
      type="text/javascript"
      src="/scripts/vinpage.js"
      defer=""
    ></script>
    <meta name="referrer" content="origin" />
    <link
      id="u-theme-google-font"
      rel="stylesheet"
      href="https://fonts.googleapis.com/css?family=Roboto:100,100i,300,300i,400,400i,500,500i,700,700i,900,900i|Open+Sans:300,300i,400,400i,500,500i,600,600i,700,700i,800,800i"
    />
    <link
      id="u-page-google-font"
      rel="stylesheet"
      href="https://fonts.googleapis.com/css?family=Montserrat:100,100i,200,200i,300,300i,400,400i,500,500i,600,600i,700,700i,800,800i,900,900i|Doppio+One:400"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.10.2/css/all.css"
    />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">

    <meta name="theme-color" content="#478ac9" />
    <meta property="og:title" content="Home" />
    <meta property="og:description" content="" />
    <meta property="og:type" content="website" />
    <meta data-intl-tel-input-cdn-path="intlTelInput/" />
  </head>

  <body
    data-path-to-root="./"
    data-include-products="false"
    class="u-body u-xl-mode"
    data-lang="en"
    style="overflow-y: scroll"
  >
    <header class="u-black u-clearfix u-header u-header" id="sec-35cf">
      <div class="u-clearfix u-sheet u-sheet-1">
        <a
          href="/"
          class="u-image u-logo u-image-1"
          title="logo"
          data-image-width="640"
          data-image-height="832"
        >
          <img src="images/logo222.png" class="u-logo-image u-logo-image-1" />
        </a>
        <nav class="u-menu u-menu-dropdown u-offcanvas u-menu-1">
          <div
            class="menu-collapse"
            style="font-size: 1rem; letter-spacing: 0px"
          >
            <a
              class="u-button-style u-custom-left-right-menu-spacing u-custom-padding-bottom u-custom-top-bottom-menu-spacing u-nav-link u-text-active-palette-1-base u-text-hover-palette-2-base"
              href="#"
            >
              <svg class="u-svg-link" viewBox="0 0 24 24">
                <use
                  xmlns:xlink="http://www.w3.org/1999/xlink"
                  xlink:href="#menu-hamburger"
                ></use>
              </svg>
              <svg
                class="u-svg-content"
                version="1.1"
                id="menu-hamburger"
                viewBox="0 0 16 16"
                x="0px"
                y="0px"
                xmlns:xlink="http://www.w3.org/1999/xlink"
                xmlns="http://www.w3.org/2000/svg"
              >
                <g>
                  <rect y="1" width="16" height="2"></rect>
                  <rect y="7" width="16" height="2"></rect>
                  <rect y="13" width="16" height="2"></rect>
                </g>
              </svg>
            </a>
          </div>
          <div class="u-custom-menu u-nav-container">
            <ul class="u-nav u-unstyled u-nav-1">
              <li class="u-nav-item">
                <a
                  class="u-button-style u-nav-link u-text-active-palette-1-base u-text-hover-palette-2-base"
                  href="/secrets"
                  style="padding: 10px 20px"
                  >UserDashboard</a
                >
              </li>
              <li class="u-nav-item">
                <a
                  class="u-button-style u-nav-link u-text-active-palette-1-base u-text-hover-palette-2-base"
                  href="/search"
                  style="padding: 10px 20px"
                  >Stock search</a
                >
              </li>
              <li class="u-nav-item">
                <a
                  class="u-button-style u-nav-link u-text-active-palette-1-base u-text-hover-palette-2-base"
                  style="padding: 10px 20px"
                  >Companies</a
                >
                <div class="u-nav-popup">
                  <ul class="u-h-spacing-20 u-nav u-unstyled u-v-spacing-10">
                    <li class="u-nav-item">
                      <a
                        class="u-button-style u-nav-link u-white"
                        href="/seover"
                        >Information</a
                      >
                    </li>
                    <li class="u-nav-item">
                      <a
                        class="u-button-style u-nav-link u-white"
                        href="/sestate"
                        >Income Statement</a
                      >
                    </li>
                  </ul>
                </div>
              </li>
              <li class="u-nav-item">
                <a
                  class="u-button-style u-nav-link u-text-active-palette-1-base u-text-hover-palette-2-base"
                  href="/stocklist"
                  style="padding: 10px 20px"
                  >Favorite</a
                >
              </li>
              <li class="u-nav-item">
                <a
                  class="u-button-style u-nav-link u-text-active-palette-1-base u-text-hover-palette-2-base"
                  href="/logout"
                  style="padding: 10px 20px"
                  >Logout</a
                >
              </li>
              <!-- Show user email -->
              <li class="u-nav-item">
                <a class="u-button-style u-nav-link" href="/stocklist">
                  <i class="fa fa-user"></i> <%= userEmail %></a
                >
              </li>
            </ul>
          </div>
          <div class="u-custom-menu u-nav-container-collapse">
            <div
              class="u-black u-container-style u-inner-container-layout u-opacity u-opacity-95 u-sidenav"
            >
              <div class="u-inner-container-layout u-sidenav-overflow">
                <div class="u-menu-close"></div>
                <ul
                  class="u-align-center u-nav u-popupmenu-items u-unstyled u-nav-3"
                >
                  <li class="u-nav-item">
                    <a class="u-button-style u-nav-link" href="/secrets"
                      >UserDashboard</a
                    >
                  </li>
                  <li class="u-nav-item">
                    <a class="u-button-style u-nav-link" href="/search"
                      >Stock search</a
                    >
                  </li>
                  <li class="u-nav-item">
                    <a class="u-button-style u-nav-link">Companies</a>
                    <div class="u-nav-popup">
                      <ul
                        class="u-h-spacing-20 u-nav u-unstyled u-v-spacing-10"
                      >
                        <li class="u-nav-item">
                          <a class="u-button-style u-nav-link" href="/seover"
                            >Information</a
                          >
                        </li>
                        <li class="u-nav-item">
                          <a class="u-button-style u-nav-link" href="/sestate"
                            >Income Statement</a
                          >
                        </li>
                      </ul>
                    </div>
                  </li>
                  <li class="u-nav-item">
                    <a class="u-button-style u-nav-link" href="/stocklist"
                      >Favorite</a
                    >
                  </li>
                  <li class="u-nav-item">
                    <a class="u-button-style u-nav-link" href="/logout"
                      >Logout</a
                    >
                  </li>
                  <!-- Show user email -->
                  <li class="u-nav-item">
                    <a class="u-button-style u-nav-link" href="/stocklist">
                      <i class="fa fa-user"></i> <%= userEmail %></a
                    >
                  </li>
                </ul>
              </div>
            </div>
            <div class="u-black u-menu-overlay u-opacity u-opacity-70"></div>
          </div>
        </nav>
      </div>
    </header>

    <div class="centered-container">
      <div class="container-inner">
        <h2><%= symbol %></h2>
        <div>
          <label for="timeSerie">Time Serie:</label>
          <div id="timeSerie"><%= timeSerie %></div>
        </div>
        <p>Last update of stock symbol <%= symbol %> was <%= latestDayTimestamp %>.</p>
      </div>
    </div>

    <!-- Add the div element for the Google Candlestick Chart -->
    <div class="centered-container">
      <div class="container-inner">
        <div id="googleCandlestickChart"></div>
      </div>
    </div>

    <form
      id="myForm"
      method="post"
      action="/result?symbol=<%=symbol%>"
      class="button-container"
    >
      <button
        type="submit"
        name="dailyPrice"
        value="Get Daily Price"
        onclick="displayClickedButton(this)"
        class="btn btn-secondary"
        style="background-color:#333;"
      >
        Daily
      </button>
      <button
        type="submit"
        name="intradayPrice"
        value="Get Intraday Price"
        onclick="displayClickedButton(this)"
        class="btn btn-secondary"
        style="background-color:#333;"
      >
        Intraday
      </button>
      <button
        type="submit"
        name="weeklyPrice"
        value="Get Weekly Price"
        onclick="displayClickedButton(this)"
        class="btn btn-secondary"
        style="background-color:#333;"
      >
        Weekly
      </button>
      <button
        type="submit"
        name="monthlyPrice"
        value="Get Monthly Price"
        onclick="displayClickedButton(this)"
        class="btn btn-secondary"
        style="background-color:#333;"
      >
        Monthly
      </button>
      <button
        type="submit"
        name="companyOverview"
        value="Get Company Overview"
        onclick="displayClickedButton(this)"
        class="btn btn-secondary"
      >
        Company Overview
      </button>
      <button
        type="submit"
        name="incomeStatement"
        value="Get Income Statement"
        onclick="displayClickedButton(this)"
        class="btn btn-secondary"
      >
        Income Statement
      </button>
    </form>

    <form
      id="addForm"
      method="POST"
      action="/add?symbol=<%=symbol%>"
      class="button-container"
    >
      <button type="submit" name="add" value="<%=symbol%>">Add to List</button>
    </form>

    <!--Back button-->
    <form id="addForm" method="GET" action="/" class="button-container">
      <button type="submit" name="back">Back</button>
    </form>
    

    <div class="response-area">
      <% if (Array.isArray(content) && content.length > 0) { %>
      <!-- Add the JavaScript code to render the Google Candlestick Chart -->
      <script
        type="text/javascript"
        src="https://www.gstatic.com/charts/loader.js"
      ></script>
      <script type="text/javascript">
        google.charts.load('current', {'packages':['corechart']});
        google.charts.setOnLoadCallback(drawChart);

        function drawChart() {
          var data = new google.visualization.DataTable();
          data.addColumn('string', '');
          data.addColumn('number', '');
          data.addColumn('number', '');
          data.addColumn('number', '');
          data.addColumn('number', '');

          var candlestickData = [];
          <% content.slice(0, 52).reverse().forEach((price) => { %>
            candlestickData.push(['<%= price.timestamp %>', <%= price.lowPrice || 0 %>, <%= price.openPrice || 0 %>, <%= price.closePrice || 0 %>, <%= price.highPrice || 0 %>]);
          <% }) %>

          data.addRows(candlestickData);

          var options = {
            legend: 'none',
            animation: {startup: true, duration: 1000, easing:'inAndOut'},
            candlestick: {
              fallingColor: { strokeWidth: 1, fill:'#a52714', stroke: '#a52714', hollowIsRising: true }, // red candles
              risingColor: { strokeWidth: 1, fill:'#0f9d58', stroke: '#0f9d58' }, // green candles
            },
            hAxis: {
              title: 'Date'
            },
            vAxis: {
              title: 'US Dollar ($)'
            }
          };

          var chart = new google.visualization.CandlestickChart(document.getElementById('googleCandlestickChart'));
          chart.draw(data, options);
        }
      </script>
      

      <% } else { %> <% if (content && content === "Error!") { %>
      <p>Error fetching stock price data for <%= symbol %>.</p>
      <% } else { %>
      <p>No stock price data available for <%= symbol %>.</p>
      <% } %> <% } %>
    </div>

    <footer
      class="u-align-center u-clearfix u-footer u-grey-80 u-footer"
      id="sec-6f38"
    >
      <div class="u-clearfix u-sheet u-sheet-1">
        <p class="u-small-text u-text u-text-variant u-text-1">Copyright</p>
      </div>
    </footer>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
  </body>
</html>
